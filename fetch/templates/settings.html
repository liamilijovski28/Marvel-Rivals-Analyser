<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Settings</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='styles/styles.css') }}">
</head>
<body>
  {% set current_path = request.path %}
  <header class="navbar">
    <nav>
      <ul>
        <li><a class="{% if current_path == '/' or current_path == '/home' %}active{% endif %}" href="{{ url_for('home') }}">Home</a></li>
        <li><a class="{% if current_path == '/friends' %}active{% endif %}" href="{{ url_for('friends') }}">Friends</a></li>
        <li><a class="{% if current_path == '/heroes' %}active{% endif %}" href="{{ url_for('heroes') }}">Heroes</a></li>
        <li><a class="{% if current_path == '/matches' %}active{% endif %}" href="{{ url_for('matches') }}">Matches</a></li>
        <li><a class="{% if current_path == '/compare' %}active{% endif %}" href="{{ url_for('compare') }}">Compare</a></li>
        <li><a class="{% if current_path == '/settings' %}active{% endif %}" href="{{ url_for('settings') }}">Settings</a></li>
      </ul>
    </nav>
  </header>

  <div class="auth-container">
    <h1>Settings</h1>

    {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
        {% for category, message in messages %}
          <div class="flash-message {{ category }}">{{ message }}</div>
        {% endfor %}
      {% endif %}
    {% endwith %}

    <!-- Unified Form Start -->
    <form method="POST" action="{{ url_for('settings') }}">
      {{ form.hidden_tag() }}

      <h2>Update Account Info</h2>
      <label for="new_username">New Username</label>
      {{ form.new_username(id="new_username", class_="form-input") }}

      <label for="new_password">New Password</label>
      {{ form.new_password(id="new_password", class_="form-input") }}

      <label for="confirm_password">Confirm Password</label>
      {{ form.confirm_password(id="confirm_password", class_="form-input") }}

      <label for="new_player_id">New Player ID</label>
      {{ form.new_player_id(id="new_player_id", class_="form-input") }}

      <button type="submit" name="update_settings" class="form-button">Update Settings</button>

      <hr>

      <h2>Friend Sharing</h2>
      <label for="allow_friend_sharing">{{ form.allow_friend_sharing.label }}</label>
      {{ form.allow_friend_sharing(id="allow_friend_sharing", class_="form-checkbox") }}

      <button type="submit" name="save_friends" class="form-button">Save Sharing Preferences</button>

      <hr>

      <h2>Account Management</h2>
      <button type="submit" name="logout" class="form-button">Logout</button>
      <button type="submit" name="close_account" class="form-button">Close Account</button>
    </form>
    <!-- Unified Form End -->
  </div>
</body>
</html>
